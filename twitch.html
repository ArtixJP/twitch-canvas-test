<!DOCTYPE html>

<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://unpkg.com https://esm.sh https://esm.run https://cdn.tailwindcss.com https://threejs.org https://cdn.threejs.org https://cdn.p5js.org https://code.jquery.com https://d3js.org https://cdn.plot.ly https://cdn.tonejs.org; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; media-src 'self' https:; font-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; worker-src 'self'; frame-src https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; connect-src 'self' https: wss: ws:; object-src 'none'; base-uri 'self'; form-action 'self';">
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>‚ö´ Othello - Reversi ‚ö™</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
        font-family: 'Segoe UI', system-ui, sans-serif; 
        min-height: 100vh; 
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }
    
    h1 {
        font-size: 2.5rem;
        margin-bottom: 20px;
        background: linear-gradient(90deg, #2ecc71, #fff, #2ecc71);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
    }
    
    .game-container {
        display: flex;
        gap: 30px;
        flex-wrap: wrap;
        justify-content: center;
        align-items: flex-start;
    }
    
    .board-container {
        background: linear-gradient(135deg, #2d2d44, #1a1a2e);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }
    
    .board {
        display: grid;
        grid-template-columns: repeat(8, 55px);
        grid-template-rows: repeat(8, 55px);
        border: 4px solid #2ecc71;
        border-radius: 8px;
        overflow: hidden;
        background: #0a5c36;
    }
    
    .square {
        width: 55px;
        height: 55px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s;
        user-select: none;
        position: relative;
        background: #0d7a47;
        border: 1px solid #0a5c36;
    }
    
    .square:hover { 
        background: #10935a; 
    }
    
    .square.valid-move {
        background: #15a866;
    }
    
    .square.valid-move::after {
        content: '';
        width: 15px;
        height: 15px;
        background: rgba(255,255,255,0.3);
        border-radius: 50%;
        position: absolute;
        animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(0.8); opacity: 0.5; }
        50% { transform: scale(1.2); opacity: 1; }
    }
    
    .piece {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        transition: all 0.3s ease;
        box-shadow: 0 4px 8px rgba(0,0,0,0.4), inset 0 2px 4px rgba(255,255,255,0.2);
    }
    
    .piece.black {
        background: radial-gradient(circle at 30% 30%, #555, #111);
    }
    
    .piece.white {
        background: radial-gradient(circle at 30% 30%, #fff, #ccc);
    }
    
    .piece.flipping {
        animation: flip 0.5s ease-in-out;
    }
    
    @keyframes flip {
        0% { transform: rotateY(0deg); }
        50% { transform: rotateY(90deg); }
        100% { transform: rotateY(180deg); }
    }
    
    .piece.new {
        animation: placepiece 0.3s ease-out;
    }
    
    @keyframes placepiece {
        0% { transform: scale(0); }
        70% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    
    .controls {
        background: linear-gradient(135deg, #2d2d44, #1a1a2e);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        min-width: 280px;
    }
    
    .turn-indicator {
        text-align: center;
        padding: 15px;
        background: rgba(46, 204, 113, 0.1);
        border: 2px solid #2ecc71;
        border-radius: 10px;
        margin-bottom: 20px;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }
    
    .turn-disc {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        display: inline-block;
    }
    
    .turn-disc.black {
        background: radial-gradient(circle at 30% 30%, #555, #111);
        box-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    .turn-disc.white {
        background: radial-gradient(circle at 30% 30%, #fff, #ccc);
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .score-board {
        display: flex;
        justify-content: space-around;
        margin-bottom: 20px;
        padding: 15px;
        background: rgba(0,0,0,0.2);
        border-radius: 10px;
    }
    
    .score {
        text-align: center;
    }
    
    .score-disc {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin: 0 auto 10px;
    }
    
    .score-disc.black {
        background: radial-gradient(circle at 30% 30%, #555, #111);
        box-shadow: 0 3px 6px rgba(0,0,0,0.5);
    }
    
    .score-disc.white {
        background: radial-gradient(circle at 30% 30%, #fff, #ccc);
        box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    }
    
    .score-num {
        font-size: 2rem;
        font-weight: bold;
        color: #2ecc71;
    }
    
    .btn {
        width: 100%;
        padding: 12px;
        font-size: 1rem;
        font-weight: bold;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        margin-bottom: 10px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #2ecc71, #27ae60);
        color: white;
    }
    
    .btn-secondary {
        background: rgba(255,255,255,0.1);
        color: white;
        border: 2px solid rgba(255,255,255,0.3);
    }
    
    .btn:hover { transform: scale(1.02); filter: brightness(1.1); }
    
    .help-section {
        margin-top: 20px;
        padding: 15px;
        background: rgba(0,0,0,0.2);
        border-radius: 10px;
        font-size: 0.85rem;
    }
    
    .help-section h3 {
        color: #2ecc71;
        margin-bottom: 10px;
    }
    
    .help-section p {
        color: #aaa;
        margin: 5px 0;
    }
    
    .status-message {
        text-align: center;
        padding: 10px;
        margin-top: 10px;
        border-radius: 8px;
        font-weight: bold;
    }
    
    .status-message.error { background: rgba(255,0,0,0.3); color: #ff6b6b; }
    .status-message.success { background: rgba(0,255,0,0.3); color: #7fc97f; }
    .status-message.info { background: rgba(46, 204, 113, 0.3); color: #2ecc71; }
</style>
</head>
<body>
<h1>‚ö´ Othello - Reversi ‚ö™</h1>
<div class="game-container">
<div class="board-container">
<div class="board" id="board"></div>
</div>
<div class="controls">
<div class="turn-indicator" id="turn-indicator">
<span class="turn-disc black"></span>
<span>Black's Turn</span>
</div>
<div class="score-board">
<div class="score">
<div class="score-disc black"></div>
<div class="score-num" id="black-score">2</div>
</div>
<div class="score">
<div class="score-disc white"></div>
<div class="score-num" id="white-score">2</div>
</div>
</div>
<button class="btn btn-primary" id="reset-game">üîÑ New Game</button>
<button class="btn btn-secondary" id="pass-turn">‚è≠Ô∏è Pass Turn</button>
<button class="btn btn-secondary" id="random-move">üé≤ Random Move</button>
<div class="status-message" id="status-message" style="display:none;"></div>
<div class="help-section">
<h3>üìñ How to Play Othello</h3>
<p>‚ö´ Black always moves first</p>
<p>üéØ Click a valid square to place your disc</p>
<p>üîÑ Capture opponent discs by flanking them</p>
<p>üìê Flank horizontally, vertically, or diagonally</p>
<p>‚è≠Ô∏è Pass if you have no valid moves</p>
<p>üèÜ Most discs when board is full wins!</p>
</div>
</div>
</div>
<script>
let board = [];
let currentPlayer = 'black';
let gameOver = false;

const DIRECTIONS = [
    [-1, -1], [-1, 0], [-1, 1],
    [0, -1],          [0, 1],
    [1, -1], [1, 0], [1, 1]
];

function initBoard() {
    board = Array(8).fill(null).map(() => Array(8).fill(null));
    // Initial setup
    board[3][3] = 'white';
    board[3][4] = 'black';
    board[4][3] = 'black';
    board[4][4] = 'white';
    currentPlayer = 'black';
    gameOver = false;
    document.getElementById('status-message').style.display = 'none';
    renderBoard();
    updateScore();
    updateTurnIndicator();
}

function renderBoard() {
    const boardEl = document.getElementById('board');
    boardEl.innerHTML = '';
    const validMoves = getValidMoves(currentPlayer);
    
    for (let row = 0; row < 8; row++) {
        for (let col = 0; col < 8; col++) {
            const square = document.createElement('div');
            square.className = 'square';
            square.dataset.row = row;
            square.dataset.col = col;
            
            if (validMoves.some(m => m.row === row && m.col === col)) {
                square.classList.add('valid-move');
            }
            
            const piece = board[row][col];
            if (piece) {
                const pieceEl = document.createElement('div');
                pieceEl.className = `piece ${piece}`;
                square.appendChild(pieceEl);
            }
            
            square.addEventListener('click', () => handleClick(row, col));
            boardEl.appendChild(square);
        }
    }
}

function handleClick(row, col) {
    if (gameOver) return;
    
    const validMoves = getValidMoves(currentPlayer);
    const move = validMoves.find(m => m.row === row && m.col === col);
    
    if (move) {
        makeMove(row, col, currentPlayer);
    }
}

function getValidMoves(player) {
    const moves = [];
    for (let row = 0; row < 8; row++) {
        for (let col = 0; col < 8; col++) {
            if (!board[row][col] && getFlips(row, col, player).length > 0) {
                moves.push({ row, col });
            }
        }
    }
    return moves;
}

function getFlips(row, col, player) {
    const opponent = player === 'black' ? 'white' : 'black';
    const flips = [];
    
    for (const [dr, dc] of DIRECTIONS) {
        const dirFlips = [];
        let r = row + dr;
        let c = col + dc;
        
        while (r >= 0 && r < 8 && c >= 0 && c < 8 && board[r][c] === opponent) {
            dirFlips.push({ row: r, col: c });
            r += dr;
            c += dc;
        }
        
        if (dirFlips.length > 0 && r >= 0 && r < 8 && c >= 0 && c < 8 && board[r][c] === player) {
            flips.push(...dirFlips);
        }
    }
    
    return flips;
}

function makeMove(row, col, player) {
    const flips = getFlips(row, col, player);
    
    board[row][col] = player;
    
    // Animate the placed piece
    renderBoard();
    const placedSquare = document.querySelector(`[data-row="${row}"][data-col="${col}"] .piece`);
    if (placedSquare) placedSquare.classList.add('new');
    
    // Flip pieces with animation
    setTimeout(() => {
        for (const flip of flips) {
            board[flip.row][flip.col] = player;
            const flipSquare = document.querySelector(`[data-row="${flip.row}"][data-col="${flip.col}"] .piece`);
            if (flipSquare) {
                flipSquare.classList.add('flipping');
            }
        }
        setTimeout(() => {
            renderBoard();
            updateScore();
            switchTurn();
        }, 300);
    }, 100);
}

function switchTurn() {
    const opponent = currentPlayer === 'black' ? 'white' : 'black';
    
    if (getValidMoves(opponent).length > 0) {
        currentPlayer = opponent;
        updateTurnIndicator();
        renderBoard();
    } else if (getValidMoves(currentPlayer).length > 0) {
        showStatus(`${opponent.charAt(0).toUpperCase() + opponent.slice(1)} has no moves! ${currentPlayer.charAt(0).toUpperCase() + currentPlayer.slice(1)} goes again.`, 'info');
        renderBoard();
    } else {
        endGame();
    }
}

function passTurn() {
    if (gameOver) return;
    
    if (getValidMoves(currentPlayer).length === 0) {
        const opponent = currentPlayer === 'black' ? 'white' : 'black';
        if (getValidMoves(opponent).length > 0) {
            currentPlayer = opponent;
            updateTurnIndicator();
            renderBoard();
            showStatus('Turn passed!', 'info');
        } else {
            endGame();
        }
    } else {
        showStatus('You have valid moves available!', 'error');
    }
}

function endGame() {
    gameOver = true;
    const blackCount = countPieces('black');
    const whiteCount = countPieces('white');
    
    let message;
    if (blackCount > whiteCount) {
        message = `‚ö´ Black wins! ${blackCount} - ${whiteCount}`;
    } else if (whiteCount > blackCount) {
        message = `‚ö™ White wins! ${whiteCount} - ${blackCount}`;
    } else {
        message = `ü§ù It's a tie! ${blackCount} - ${whiteCount}`;
    }
    
    showStatus(message, 'success');
}

function countPieces(player) {
    let count = 0;
    for (let row = 0; row < 8; row++) {
        for (let col = 0; col < 8; col++) {
            if (board[row][col] === player) count++;
        }
    }
    return count;
}

function updateScore() {
    document.getElementById('black-score').textContent = countPieces('black');
    document.getElementById('white-score').textContent = countPieces('white');
}

function updateTurnIndicator() {
    const indicator = document.getElementById('turn-indicator');
    indicator.innerHTML = `<span class="turn-disc ${currentPlayer}"></span><span>${currentPlayer.charAt(0).toUpperCase() + currentPlayer.slice(1)}'s Turn</span>`;
}

function showStatus(message, type) {
    const status = document.getElementById('status-message');
    status.textContent = message;
    status.className = `status-message ${type}`;
    status.style.display = 'block';
}

document.getElementById('reset-game').addEventListener('click', initBoard);
document.getElementById('pass-turn').addEventListener('click', passTurn);
document.getElementById('random-move').addEventListener('click', playRandomMove);

function playRandomMove() {
    if (gameOver) return;
    
    const validMoves = getValidMoves(currentPlayer);
    if (validMoves.length === 0) {
        showStatus('No valid moves available!', 'error');
        return;
    }
    
    const randomIndex = Math.floor(Math.random() * validMoves.length);
    const move = validMoves[randomIndex];
    showStatus(`üé≤ Random move: row ${move.row + 1}, col ${move.col + 1}`, 'info');
    makeMove(move.row, move.col, currentPlayer);
}

initBoard();
</script>
</body>
</html>