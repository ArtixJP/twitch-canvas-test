<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Twitch Versus Code</title>
<style>
        body { 
            font-family: system-ui, sans-serif; 
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0;
            background: linear-gradient(135deg, #0a0a1a 0%, #0d1117 100%);
            color: white;
            overflow: hidden;
            position: relative;
        }
        
        #three-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        
        h1 { 
            font-size: 3rem; 
            text-align: center; 
            z-index: 10;
            margin-bottom: 2rem;
            text-shadow: 0 0 20px rgba(255, 200, 100, 0.5);
            position: relative;
        }
        
        .planet-container {
            position: relative;
            width: 300px;
            height: 300px;
            animation: float 6s ease-in-out infinite;
            z-index: 5;
        }
        
        .planet {
            position: relative;
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4a90e2 0%, #2c5aa0 50%, #1a3a6e 100%);
            box-shadow: 
                inset -40px -40px 80px rgba(0, 0, 0, 0.5),
                inset 20px 20px 40px rgba(255, 255, 255, 0.1),
                0 0 100px rgba(74, 144, 226, 0.6),
                0 0 200px rgba(74, 144, 226, 0.3),
                -80px -80px 100px rgba(255, 200, 100, 0.2);
            animation: rotate 20s linear infinite;
            overflow: hidden;
        }
        
        .planet::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 40%;
            height: 40%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.4), transparent);
            border-radius: 50%;
            filter: blur(20px);
        }
        
        .planet::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, transparent 0%, rgba(100, 150, 200, 0.3) 50%, transparent 100%);
            animation: shimmer 8s ease-in-out infinite;
        }
        
        .atmosphere {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 270px;
            height: 270px;
            border-radius: 50%;
            background: radial-gradient(circle, transparent 60%, rgba(74, 144, 226, 0.4) 80%, transparent 100%);
            animation: pulse 4s ease-in-out infinite;
        }
        
        .ring {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 100px;
            border: 3px solid rgba(150, 180, 220, 0.6);
            border-radius: 50%;
            transform: translate(-50%, -50%) rotateX(75deg);
            box-shadow: 
                0 0 20px rgba(150, 180, 220, 0.4),
                inset 0 0 20px rgba(150, 180, 220, 0.3),
                -50px -50px 60px rgba(255, 200, 100, 0.15);
        }
        
        .ring::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 90%;
            height: 80%;
            border: 2px solid rgba(180, 200, 230, 0.4);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .moon-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 400px;
            transform: translate(-50%, -50%);
            animation: orbit 15s linear infinite;
            pointer-events: none;
        }
        
        .moon {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e0e0e0 0%, #b0b0b0 50%, #808080 100%);
            box-shadow: 
                inset -15px -15px 30px rgba(0, 0, 0, 0.4),
                inset 8px 8px 15px rgba(255, 255, 255, 0.3),
                0 0 30px rgba(224, 224, 224, 0.4),
                0 0 60px rgba(224, 224, 224, 0.2),
                -30px -30px 40px rgba(255, 200, 100, 0.2);
            animation: moon-rotate 15s linear infinite reverse;
        }
        
        .moon::before {
            content: '';
            position: absolute;
            top: 20%;
            left: 30%;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(100, 100, 100, 0.4);
            box-shadow: 
                15px 10px 0 -2px rgba(100, 100, 100, 0.3),
                -5px 20px 0 -3px rgba(100, 100, 100, 0.35),
                20px -5px 0 -1px rgba(100, 100, 100, 0.25);
        }
        
        .moon::after {
            content: '';
            position: absolute;
            top: 15%;
            left: 15%;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 50%;
            filter: blur(8px);
        }
        
        .kitty-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 350px;
            height: 350px;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }
        
        .kitty-orbit.escaping {
            animation: orbit-fast 3s linear infinite !important;
        }
        
        .kitty-orbit.normal {
            animation: orbit 12s linear infinite !important;
        }
        
        .kitty {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 45px;
            filter: drop-shadow(-5px -5px 8px rgba(255, 200, 100, 0.3));
        }
        
        .kitty-orbit.escaping .kitty {
            animation: kitty-rotate-fast 3s linear infinite reverse, kitty-bounce-fast 0.3s ease-in-out infinite !important;
        }
        
        .kitty-orbit.normal .kitty {
            animation: kitty-rotate 12s linear infinite reverse, kitty-bounce 0.8s ease-in-out infinite !important;
        }
        
        .kitty-orbit.escaping .kitty-glow {
            animation: glow-pulse-fast 0.5s ease-in-out infinite !important;
            background: radial-gradient(circle, rgba(255, 50, 50, 0.6) 0%, transparent 70%) !important;
        }
        
        .kitty-body {
            position: relative;
            width: 40px;
            height: 35px;
            background: linear-gradient(135deg, #ff9a8b 0%, #ff6b9d 50%, #ff5e9d 100%);
            border-radius: 60% 60% 50% 50%;
            margin: 0 auto;
            box-shadow: 0 5px 15px rgba(255, 106, 157, 0.5);
        }
        
        .kitty-ear {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 15px solid #ff6b9d;
            top: -10px;
        }
        
        .kitty-ear.left {
            left: 3px;
            transform: rotate(-15deg);
        }
        
        .kitty-ear.right {
            right: 3px;
            transform: rotate(15deg);
        }
        
        .kitty-orbit.escaping .kitty-ear.left {
            transform: rotate(-35deg) !important;
        }
        
        .kitty-orbit.escaping .kitty-ear.right {
            transform: rotate(35deg) !important;
        }
        
        .kitty-ear::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 10px solid #ff9aa2;
            top: 3px;
            left: -5px;
        }
        
        .kitty-face {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 25px;
        }
        
        .kitty-eye {
            position: absolute;
            width: 6px;
            height: 8px;
            background: #2c3e50;
            border-radius: 50%;
            top: 5px;
            animation: kitty-blink 3s ease-in-out infinite;
        }
        
        .kitty-orbit.escaping .kitty-eye {
            width: 8px !important;
            height: 10px !important;
            animation: none !important;
        }
        
        .kitty-eye.left {
            left: 6px;
        }
        
        .kitty-eye.right {
            right: 6px;
        }
        
        .kitty-eye::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 3px;
            background: white;
            border-radius: 50%;
            top: 1px;
            left: 1px;
        }
        
        .kitty-nose {
            position: absolute;
            width: 5px;
            height: 4px;
            background: #ff4757;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .kitty-whisker {
            position: absolute;
            width: 15px;
            height: 1px;
            background: rgba(255, 255, 255, 0.6);
            top: 14px;
        }
        
        .kitty-whisker.left {
            left: -12px;
            transform: rotate(-10deg);
        }
        
        .kitty-whisker.right {
            right: -12px;
            transform: rotate(10deg);
        }
        
        .kitty-whisker.left-2 {
            left: -11px;
            top: 17px;
            transform: rotate(-5deg);
        }
        
        .kitty-whisker.right-2 {
            right: -11px;
            top: 17px;
            transform: rotate(5deg);
        }
        
        .kitty-tail {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid #ff6b9d;
            border-color: #ff6b9d transparent transparent transparent;
            border-radius: 50%;
            bottom: 0;
            right: -8px;
            transform: rotate(45deg);
            animation: tail-wag 1s ease-in-out infinite;
        }
        
        .kitty-orbit.escaping .kitty-tail {
            animation: tail-wag-fast 0.2s ease-in-out infinite !important;
        }
        
        .kitty-glow {
            position: absolute;
            top: -5px;
            left: -5px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 106, 157, 0.3) 0%, transparent 70%);
            animation: glow-pulse 2s ease-in-out infinite;
        }
        
        .dog-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 350px;
            height: 350px;
            transform: translate(-50%, -50%);
            animation: orbit 8s linear infinite;
            pointer-events: none;
        }
        
        .dog {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 55px;
            height: 50px;
            animation: dog-rotate 8s linear infinite reverse, dog-bounce 0.5s ease-in-out infinite;
            filter: drop-shadow(-5px -5px 8px rgba(255, 150, 50, 0.3));
        }
        
        .dog-glow {
            position: absolute;
            top: -5px;
            left: -5px;
            width: 65px;
            height: 60px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 150, 50, 0.3) 0%, transparent 70%);
            animation: glow-pulse 1.5s ease-in-out infinite;
        }
        
        .dog-body {
            position: relative;
            width: 45px;
            height: 40px;
            background: linear-gradient(135deg, #ff8c42 0%, #ff6b35 50%, #ff5722 100%);
            border-radius: 50% 50% 50% 50%;
            margin: 0 auto;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.5);
        }
        
        .dog-ear {
            position: absolute;
            width: 15px;
            height: 20px;
            background: #ff6b35;
            border-radius: 50% 50% 0 0;
            top: -8px;
        }
        
        .dog-ear.left {
            left: 5px;
            transform: rotate(-20deg);
        }
        
        .dog-ear.right {
            right: 5px;
            transform: rotate(20deg);
        }
        
        .dog-ear::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 12px;
            background: #ff8c42;
            border-radius: 50%;
            top: 3px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .dog-face {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 28px;
        }
        
        .dog-eye {
            position: absolute;
            width: 7px;
            height: 9px;
            background: #2c3e50;
            border-radius: 50%;
            top: 5px;
            animation: dog-blink 4s ease-in-out infinite;
        }
        
        .dog-eye.left {
            left: 7px;
        }
        
        .dog-eye.right {
            right: 7px;
        }
        
        .dog-eye::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 3px;
            background: white;
            border-radius: 50%;
            top: 1px;
            left: 1px;
        }
        
        .dog-snout {
            position: absolute;
            width: 18px;
            height: 15px;
            background: #ff9f66;
            border-radius: 50% 50% 60% 60%;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .dog-nose {
            position: absolute;
            width: 8px;
            height: 6px;
            background: #2c3e50;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .dog-tongue {
            position: absolute;
            width: 8px;
            height: 10px;
            background: #ff6b9d;
            border-radius: 0 0 50% 50%;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            animation: tongue-wag 0.6s ease-in-out infinite;
        }
        
        .dog-tail {
            position: absolute;
            width: 25px;
            height: 25px;
            border: 3px solid #ff6b35;
            border-color: transparent transparent #ff6b35 transparent;
            border-radius: 50%;
            bottom: 5px;
            right: -10px;
            transform: rotate(-45deg);
            animation: dog-tail-wag 0.3s ease-in-out infinite;
        }
        
        .stars {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow: 
                100px 200px white,
                -150px 100px white,
                200px -100px white,
                -200px -150px white,
                300px 50px white,
                -300px 200px white,
                150px -200px white,
                -100px -250px white,
                400px 150px white,
                -350px -100px white,
                250px 250px rgba(255, 255, 255, 0.5),
                -250px 150px rgba(255, 255, 255, 0.5),
                350px -150px rgba(255, 255, 255, 0.5),
                -400px 50px rgba(255, 255, 255, 0.5);
            animation: twinkle 3s ease-in-out infinite;
        }
        
        .music-control {
            position: fixed;
            bottom: 40px;
            right: 40px;
            z-index: 1000;
        }
        
        .music-button {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4a90e2, #2c5aa0);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 8px 20px rgba(74, 144, 226, 0.4),
                0 0 40px rgba(74, 144, 226, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .music-button:hover {
            transform: scale(1.1);
            box-shadow: 
                0 12px 30px rgba(74, 144, 226, 0.6),
                0 0 60px rgba(74, 144, 226, 0.4);
        }
        
        .music-button:active {
            transform: scale(0.95);
        }
        
        .music-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .music-button:hover::before {
            width: 100%;
            height: 100%;
        }
        
        .play-icon, .pause-icon {
            width: 30px;
            height: 30px;
            position: relative;
            z-index: 1;
        }
        
        .play-icon {
            width: 0;
            height: 0;
            border-left: 20px solid white;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            margin-left: 5px;
        }
        
        .pause-icon {
            display: none;
            width: 20px;
            height: 24px;
            position: relative;
        }
        
        .pause-icon::before,
        .pause-icon::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 24px;
            background: white;
            border-radius: 2px;
        }
        
        .pause-icon::before {
            left: 0;
        }
        
        .pause-icon::after {
            right: 0;
        }
        
        .music-button.playing .play-icon {
            display: none;
        }
        
        .music-button.playing .pause-icon {
            display: block;
        }
        
        .sound-waves {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }
        
        .wave {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 70px;
            height: 70px;
            border: 2px solid rgba(74, 144, 226, 0.6);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: wave-expand 2s ease-out infinite;
            opacity: 0;
        }
        
        .wave:nth-child(2) {
            animation-delay: 0.5s;
        }
        
        .wave:nth-child(3) {
            animation-delay: 1s;
        }
        
        .wave:nth-child(4) {
            animation-delay: 1.5s;
        }
        
        .music-button:not(.playing) .wave {
            animation: none;
        }
        
        @keyframes wave-expand {
            0% {
                width: 70px;
                height: 70px;
                opacity: 1;
            }
            100% {
                width: 150px;
                height: 150px;
                opacity: 0;
            }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes orbit {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        @keyframes orbit-fast {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        @keyframes moon-rotate {
            from { transform: translateX(-50%) rotate(0deg); }
            to { transform: translateX(-50%) rotate(-360deg); }
        }
        
        @keyframes kitty-rotate {
            from { transform: translateX(-50%) rotate(0deg); }
            to { transform: translateX(-50%) rotate(-360deg); }
        }
        
        @keyframes kitty-rotate-fast {
            from { transform: translateX(-50%) rotate(0deg); }
            to { transform: translateX(-50%) rotate(-360deg); }
        }
        
        @keyframes dog-rotate {
            from { transform: translateX(-50%) rotate(0deg); }
            to { transform: translateX(-50%) rotate(-360deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }
        
        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        @keyframes kitty-bounce {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }
        
        @keyframes kitty-bounce-fast {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-3px); }
        }
        
        @keyframes dog-bounce {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-8px); }
        }
        
        @keyframes kitty-blink {
            0%, 48%, 52%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.1); }
        }
        
        @keyframes dog-blink {
            0%, 48%, 52%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.1); }
        }
        
        @keyframes tail-wag {
            0%, 100% { transform: rotate(45deg); }
            50% { transform: rotate(55deg); }
        }
        
        @keyframes tail-wag-fast {
            0%, 100% { transform: rotate(35deg); }
            50% { transform: rotate(65deg); }
        }
        
        @keyframes dog-tail-wag {
            0%, 100% { transform: rotate(-45deg); }
            25% { transform: rotate(-25deg); }
            75% { transform: rotate(-65deg); }
        }
        
        @keyframes tongue-wag {
            0%, 100% { transform: translateX(-50%) scaleY(1); }
            50% { transform: translateX(-50%) scaleY(1.15); }
        }
        
        @keyframes glow-pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        
        @keyframes glow-pulse-fast {
            0%, 100% { opacity: 0.8; transform: scale(1.2); }
            50% { opacity: 1; transform: scale(1.4); }
        }
    </style>
</head>
<body>
<div id="three-container"></div>
<div class="stars"></div>
<h1>Hello World</h1>
<div class="planet-container">
<div class="ring"></div>
<div class="atmosphere"></div>
<div class="planet"></div>
<div class="moon-orbit">
<div class="moon"></div>
</div>
<div class="kitty-orbit normal">
<div class="kitty">
<div class="kitty-glow"></div>
<div class="kitty-body">
<div class="kitty-ear left"></div>
<div class="kitty-ear right"></div>
<div class="kitty-face">
<div class="kitty-eye left"></div>
<div class="kitty-eye right"></div>
<div class="kitty-nose"></div>
<div class="kitty-whisker left"></div>
<div class="kitty-whisker right"></div>
<div class="kitty-whisker left-2"></div>
<div class="kitty-whisker right-2"></div>
</div>
<div class="kitty-tail"></div>
</div>
</div>
</div>
<div class="dog-orbit">
<div class="dog">
<div class="dog-glow"></div>
<div class="dog-body">
<div class="dog-ear left"></div>
<div class="dog-ear right"></div>
<div class="dog-face">
<div class="dog-eye left"></div>
<div class="dog-eye right"></div>
<div class="dog-snout">
<div class="dog-nose"></div>
<div class="dog-tongue"></div>
</div>
</div>
<div class="dog-tail"></div>
</div>
</div>
</div>
</div>
<audio id="backgroundMusic" loop="">
<source src="https://nu.vgmtreasurechest.com/soundtracks/professor-layton-and-the-unwound-future-hd-android-ios-mobile-gamerip-2020/bhjayocv/08.%20More%20London%20Streets.mp3" type="audio/mpeg"/>
</audio>
<div class="music-control">
<button class="music-button" id="musicToggle">
<div class="sound-waves">
<div class="wave"></div>
<div class="wave"></div>
<div class="wave"></div>
<div class="wave"></div>
</div>
<div class="play-icon"></div>
<div class="pause-icon"></div>
</button>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    // Music controls
    const audio = document.getElementById('backgroundMusic');
    const button = document.getElementById('musicToggle');
    
    window.addEventListener('load', () => {
        const playPromise = audio.play();
        
        if (playPromise !== undefined) {
            playPromise
                .then(() => {
                    button.classList.add('playing');
                })
                .catch(error => {
                    console.log('Autoplay prevented. User interaction required.');
                });
        }
    });
    
    const startMusicOnInteraction = () => {
        if (audio.paused) {
            audio.play().then(() => {
                button.classList.add('playing');
                document.removeEventListener('click', startMusicOnInteraction);
                document.removeEventListener('keydown', startMusicOnInteraction);
            }).catch(() => {});
        }
    };
    
    document.addEventListener('click', startMusicOnInteraction, { once: true });
    document.addEventListener('keydown', startMusicOnInteraction, { once: true });
    
    button.addEventListener('click', (e) => {
        e.stopPropagation();
        if (audio.paused) {
            audio.play();
            button.classList.add('playing');
        } else {
            audio.pause();
            button.classList.remove('playing');
        }
    });

    // Cat and Dog chase mechanics
    const kittyOrbit = document.querySelector('.kitty-orbit');
    const dogOrbit = document.querySelector('.dog-orbit');
    
    let kittyAngle = 0;
    let dogAngle = 180; // Start opposite to cat
    const kittyNormalSpeed = 0.5; // degrees per frame (12s for 360°)
    const kittyEscapeSpeed = 2.5; // much faster when escaping
    const dogSpeed = 0.75; // faster than normal cat (8s for 360°)
    const dangerDistance = 60; // degrees - when dog gets this close, cat escapes
    const safeDistance = 120; // degrees - when dog is this far, cat returns to normal
    
    let isEscaping = false;
    
    function updateChase() {
        // Calculate angular difference
        let diff = kittyAngle - dogAngle;
        // Normalize to -180 to 180
        while (diff > 180) diff -= 360;
        while (diff < -180) diff += 360;
        
        const distance = Math.abs(diff);
        
        // Check if cat should escape
        if (distance < dangerDistance && !isEscaping) {
            isEscaping = true;
            kittyOrbit.classList.remove('normal');
            kittyOrbit.classList.add('escaping');
        } else if (distance > safeDistance && isEscaping) {
            isEscaping = false;
            kittyOrbit.classList.remove('escaping');
            kittyOrbit.classList.add('normal');
        }
        
        // Update cat speed based on state
        const currentKittySpeed = isEscaping ? kittyEscapeSpeed : kittyNormalSpeed;
        kittyAngle += currentKittySpeed;
        
        // Update dog position (always chasing)
        dogAngle += dogSpeed;
        
        // Normalize angles
        if (kittyAngle >= 360) kittyAngle -= 360;
        if (dogAngle >= 360) dogAngle -= 360;
        
        // Apply rotations
        kittyOrbit.style.transform = `translate(-50%, -50%) rotate(${kittyAngle}deg)`;
        dogOrbit.style.transform = `translate(-50%, -50%) rotate(${dogAngle}deg)`;
        
        requestAnimationFrame(updateChase);
    }
    
    // Start the chase
    updateChase();

    // Three.js Sun Scene
    const container = document.getElementById('three-container');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    container.appendChild(renderer.domElement);
    
    // Create the Sun
    const sunGeometry = new THREE.SphereGeometry(3, 64, 64);
    const sunMaterial = new THREE.MeshBasicMaterial({
        color: 0xffaa00,
        emissive: 0xff8800,
        emissiveIntensity: 1
    });
    const sun = new THREE.Mesh(sunGeometry, sunMaterial);
    sun.position.set(-12, 8, -15);
    scene.add(sun);
    
    // Sun glow effect
    const glowGeometry = new THREE.SphereGeometry(3.5, 32, 32);
    const glowMaterial = new THREE.ShaderMaterial({
        uniforms: {
            glowColor: { value: new THREE.Color(0xffaa00) },
            viewVector: { value: camera.position }
        },
        vertexShader: `
            uniform vec3 viewVector;
            varying float intensity;
            void main() {
                vec3 vNormal = normalize(normalMatrix * normal);
                vec3 vNormel = normalize(normalMatrix * viewVector);
                intensity = pow(0.7 - dot(vNormal, vNormel), 3.0);
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,
        fragmentShader: `
            uniform vec3 glowColor;
            varying float intensity;
            void main() {
                vec3 glow = glowColor * intensity;
                gl_FragColor = vec4(glow, intensity);
            }
        `,
        side: THREE.BackSide,
        blending: THREE.AdditiveBlending,
        transparent: true
    });
    const sunGlow = new THREE.Mesh(glowGeometry, glowMaterial);
    sunGlow.position.copy(sun.position);
    scene.add(sunGlow);
    
    // Add sun corona particles
    const coronaGeometry = new THREE.BufferGeometry();
    const coronaCount = 1000;
    const coronaPositions = new Float32Array(coronaCount * 3);
    const coronaColors = new Float32Array(coronaCount * 3);
    
    for (let i = 0; i < coronaCount; i++) {
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.random() * Math.PI;
        const radius = 3.2 + Math.random() * 1.5;
        
        coronaPositions[i * 3] = sun.position.x + radius * Math.sin(phi) * Math.cos(theta);
        coronaPositions[i * 3 + 1] = sun.position.y + radius * Math.sin(phi) * Math.sin(theta);
        coronaPositions[i * 3 + 2] = sun.position.z + radius * Math.cos(phi);
        
        const color = new THREE.Color();
        color.setHSL(0.1 + Math.random() * 0.05, 1, 0.5 + Math.random() * 0.3);
        coronaColors[i * 3] = color.r;
        coronaColors[i * 3 + 1] = color.g;
        coronaColors[i * 3 + 2] = color.b;
    }
    
    coronaGeometry.setAttribute('position', new THREE.BufferAttribute(coronaPositions, 3));
    coronaGeometry.setAttribute('color', new THREE.BufferAttribute(coronaColors, 3));
    
    const coronaMaterial = new THREE.PointsMaterial({
        size: 0.15,
        vertexColors: true,
        blending: THREE.AdditiveBlending,
        transparent: true,
        opacity: 0.8
    });
    
    const corona = new THREE.Points(coronaGeometry, coronaMaterial);
    scene.add(corona);
    
    // Add powerful point light from the sun
    const sunLight = new THREE.PointLight(0xffaa00, 3, 100);
    sunLight.position.copy(sun.position);
    sunLight.castShadow = true;
    sunLight.shadow.mapSize.width = 2048;
    sunLight.shadow.mapSize.height = 2048;
    scene.add(sunLight);
    
    // Add ambient light
    const ambientLight = new THREE.AmbientLight(0x222244, 0.3);
    scene.add(ambientLight);
    
    // Create invisible spheres to receive shadows and demonstrate lighting
    const sphereGeometry = new THREE.SphereGeometry(1, 32, 32);
    const sphereMaterial = new THREE.MeshStandardMaterial({
        color: 0x4a90e2,
        metalness: 0.3,
        roughness: 0.4,
        transparent: true,
        opacity: 0.15
    });
    
    const sphere1 = new THREE.Mesh(sphereGeometry, sphereMaterial);
    sphere1.position.set(2, 1, 5);
    sphere1.castShadow = true;
    sphere1.receiveShadow = true;
    scene.add(sphere1);
    
    const sphere2 = new THREE.Mesh(sphereGeometry.clone(), sphereMaterial.clone());
    sphere2.position.set(-3, -2, 3);
    sphere2.castShadow = true;
    sphere2.receiveShadow = true;
    scene.add(sphere2);
    
    // Position camera
    camera.position.z = 10;
    camera.position.y = 2;
    
    // Animation
    let time = 0;
    function animate() {
        requestAnimationFrame(animate);
        time += 0.01;
        
        // Rotate sun
        sun.rotation.y += 0.002;
        sunGlow.rotation.y += 0.002;
        
        // Animate corona particles
        const positions = corona.geometry.attributes.position.array;
        for (let i = 0; i < coronaCount; i++) {
            const i3 = i * 3;
            const angle = time * 0.5 + i * 0.01;
            const radius = 3.2 + Math.sin(time + i * 0.1) * 0.3;
            const theta = (i / coronaCount) * Math.PI * 2 + time * 0.2;
            const phi = Math.sin(time * 0.5 + i * 0.05) * Math.PI;
            
            positions[i3] = sun.position.x + radius * Math.sin(phi) * Math.cos(theta);
            positions[i3 + 1] = sun.position.y + radius * Math.sin(phi) * Math.sin(theta);
            positions[i3 + 2] = sun.position.z + radius * Math.cos(phi);
        }
        corona.geometry.attributes.position.needsUpdate = true;
        
        // Pulse sun light
        sunLight.intensity = 3 + Math.sin(time * 2) * 0.3;
        
        // Gentle sun movement
        sun.position.y = 8 + Math.sin(time * 0.3) * 0.5;
        sunGlow.position.copy(sun.position);
        sunLight.position.copy(sun.position);
        
        // Rotate demonstration spheres
        sphere1.rotation.x += 0.01;
        sphere1.rotation.y += 0.01;
        sphere2.rotation.x -= 0.008;
        sphere2.rotation.y -= 0.008;
        
        renderer.render(scene, camera);
    }
    
    animate();
    
    // Handle window resize
    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
</body>
</html>